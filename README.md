http://docs.itglobal.ru/pages/viewpage.action?pageId=7405839

Для интеграции следует:

открыть папку %PROGRAMFILES(X86)%\Option Workshop\LUA;
скопировать в папке LUA файлы:
cjson.dll;
lua51.dll.
lua5.1.dll.
открыть папку установки QUIK;
добавить с заменой файлы в папку установки QUIK;
запустить терминал и авторизоваться;
для QUIK v.6 перейти в раздел Таблицы→LUA→Доступные скрипты.
Для QUIK v.7 перейти в раздел Сервисы→Lua скрипты...

Рисунок 1 – настройки QUIK v.6

Рисунок 2 – настройки QUIK v.7
 
нажать кнопку Добавить в окне Доступные скрипты;
выбрать файл itgQuikLuaServer.lua в проводнике Windows и нажать кнопку Открыть;
нажать кнопку Запустить (рис. 3);

Рисунок 3 – добавление скрипта
 
в интерфейсе OW нажать на кнопку  на тулбаре;

перейти во вкладку Data source, нажать кнопку Add transport и в списке выбрать QUIK(Lua);

Рисунок 4 – вкладка Data source
 

в открывшемся окне заполнить параметры и нажать кнопку OK;


Рисунок 5 – параметры QUIK

Таблица 1 – Параметры подключения

Type	Название источника
Name	Название источника, которое будет отображено на нижней панели главного окна (указывается пользователем). Название источника данных должно быть уникальным
Prefix	Приставка, которая будет добавлена к торговому счету, загруженному с источника QUIK
Enable transport	
Если снять переключатель, QUIK будет добавлен в список доступных источников, но не будет подключен (см. раздел Деактивация источника) 
IP adress	IP адрес компьютера, на котором запущен Quik. Если терминал и OW установлены на одном компьютере, следует указать localhost или 127.0.0.1
Port	Порт соединения с Quik (по умолчанию 1248)
Receive marketdata (Получать рыночные данные)	Опция может быть использована, если настроено соединение с несколькими QUIK-ми. 
В данном случае переключатель рекомендуется активировать только у одного из них
нажать кнопку ОК во вкладке Data source.

Перед установкой обновлений OW, первоначально требуется закрыть терминал.

Интеграция с двумя источниками
Для добавления второго источника необходимо:

открыть папку %PROGRAMFILES(X86)%\Option Workshop;
скопировать папку LUA в любое место на компьютере;
перейти в скопированную папку LUA;
скопировать в папке LUA файлы:
cjson.dll;
lua51.dll.
lua5.1.dll.
открыть папку установки QUIK;
добавить с заменой файлы в папку установки QUIK;
открыть в текстовом редакторе notepad (стандартный текстовый редактор для Windows) файл transport.lua;
в функции createServer, в строке 71 заменить порт 1248 на 1249, сохранить файл;

Рисунок 6 – изменения номера порта
 
в скопированной папке LUA открыть файл itgQuikLuaServer.lua в текстовом редакторе;
в строке local logFileFullPath = owLogsPath .. "itgQuikLuaServer.txt" добавить 1, сохранить файл;

Рисунок 7 – добавление скрипта

Файл нужно сохранить в кодировке ANSI.





запустить терминал QUIK и авторизоваться;
для QUIK v.6 перейти в раздел Таблицы→LUA→Доступные скрипты.
Для QUIK v.7 перейти в раздел Сервисы→Lua скрипты...

Рисунок 8 – настройки QUIK v.6
 
Рисунок 9 – настройки QUIK v.7
нажать кнопку Добавить в окне Доступные скрипты;
выбрать файл itgQuikLuaServer.lua в скопированной папке и нажать кнопку Открыть;
выбрать добавленный скрипт и нажать кнопку Запустить (рис. 10);

Рисунок 10 – запуск второго скрипта
 
в интерфейсе OW перейти во вкладку Data source, нажать кнопку Add transport и в списке выбрать источник данных;

Рисунок 11 – вкладка Data source

в открывшемся окне заполнить параметры и нажать кнопку OK;


Рисунок 12 – параметры QUIK

Таблица 2 – Параметры подключения

Type	Название источника
Name	Название источника, которое будет отображено на нижней панели главного окна (указывается пользователем). Название источника данных должно быть уникальным
Prefix	Приставка, которая будет добавлена к торговому счету, загруженному с источника QUIK
Enable transport	
Если переключатель снять, QUIK будет добавлен в список доступных источников, но не будет подключен (см. раздел Деактивация источника)  
IP adress	IP адрес компьютера, на котором запущен Quik. Если терминал и OW установлены на одном компьютере, следует указать localhost или 127.0.0.1
Port	Порт соединения с Quik (для второго источника нужно указать порт 1249)
Receive marketdata (Получать рыночные данные)	Опция может быть использована, если настроено соединение с несколькими QUIK-ми. 
В данном случае переключатель рекомендуется активировать только у одного из них
нажать кнопку ОК во вкладке Data source.


Рисунок 13 – результат подключения двух источников
 

По такому же принципу можно подключить несколько квиков. Создаем отдельную папку со скриптом, в папке в файле transport.lua меняем порт. Задаем другое, отличное от предыдущих двух значение, например, добавляем единицу.
